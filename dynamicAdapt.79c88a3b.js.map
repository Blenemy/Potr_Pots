{"version":3,"sources":["scripts/dynamicAdapt.js"],"names":["useDynamicAdapt","type","result","isMin","className","attrName","dNodes","document","querySelectorAll","forEach","element","attr","value","getAttribute","split","map","val","trim","toSelector","breakpoint","order","to","querySelector","push","parent","parentElement","undefined","isNaN","Number","index","sort","a","b","getDMediaQueries","items","uniqItems","Set","item","query","dMediaQuery","matchMedia","window","mediaHandler","getMediaHandler","matches","moveTo","dNode","getIndexInParent","children","indexOf","classList","add","length","append","prepend","before","reverse","moveBack","contains","remove","filter","addEventListener"],"mappings":"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","file":"dynamicAdapt.79c88a3b.js","sourceRoot":"..\\src","sourcesContent":["/* eslint-disable max-len */\r\n// was taken from the open-source on Github\r\n'use strict';\r\n\r\n/**\r\n * @typedef {Object} dNode\r\n * @property {HTMLElement} parent\r\n * @property {HTMLElement} element\r\n * @property {HTMLElement} to\r\n * @property {string} breakpoint\r\n * @property {string} order\r\n * @property {number} index\r\n */\r\n\r\n/**\r\n * @typedef {Object} dMediaQuery\r\n * @property {string} query\r\n * @property {number} breakpoint\r\n */\r\n\r\n/**\r\n * @param {'min' | 'max'} type\r\n */\r\nfunction useDynamicAdapt(type = 'max') {\r\n  const className = '_dynamic_adapt_';\r\n  const attrName = 'data-da';\r\n\r\n  /** @type {dNode[]} */\r\n  const dNodes = getDNodes();\r\n\r\n  /** @type {dMediaQuery[]} */\r\n  const dMediaQueries = getDMediaQueries(dNodes);\r\n\r\n  dMediaQueries.forEach((dMediaQuery) => {\r\n    const matchMedia = window.matchMedia(dMediaQuery.query);\r\n    // массив объектов с подходящим брейкпоинтом\r\n    const filteredDNodes = dNodes.filter(({ breakpoint }) => breakpoint === dMediaQuery.breakpoint);\r\n    const mediaHandler = getMediaHandler(matchMedia, filteredDNodes);\r\n\r\n    matchMedia.addEventListener('change', mediaHandler);\r\n\r\n    mediaHandler();\r\n  });\r\n\r\n  function getDNodes() {\r\n    const result = [];\r\n    const elements = [...document.querySelectorAll(`[${attrName}]`)];\r\n\r\n    elements.forEach((element) => {\r\n      const attr = element.getAttribute(attrName);\r\n      const [toSelector, breakpoint, order] = attr.split(',').map((val) => val.trim());\r\n\r\n      const to = document.querySelector(toSelector);\r\n\r\n      if (to) {\r\n        result.push({\r\n          parent: element.parentElement,\r\n          element,\r\n          to,\r\n          breakpoint: breakpoint !== undefined ? breakpoint : '767',\r\n          order: order !== undefined ? (isNumber(order) ? Number(order) : order) : 'last',\r\n          index: -1,\r\n        });\r\n      }\r\n    });\r\n\r\n    return sortDNodes(result);\r\n  }\r\n\r\n  /**\r\n   * @param {dNode} items\r\n   * @returns {dMediaQuery[]}\r\n   */\r\n  function getDMediaQueries(items) {\r\n    const uniqItems = [...new Set(items.map(({ breakpoint }) => `(${type}-width: ${breakpoint}px),${breakpoint}`))];\r\n\r\n    return uniqItems.map((item) => {\r\n      const [query, breakpoint] = item.split(',');\r\n\r\n      return {\r\n        query, breakpoint,\r\n      };\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @param {MediaQueryList} matchMedia\r\n   * @param {dNodes} items\r\n   */\r\n  function getMediaHandler(matchMedia, items) {\r\n    return function mediaHandler() {\r\n      if (matchMedia.matches) {\r\n        items.forEach((item) => {\r\n          moveTo(item);\r\n        });\r\n\r\n        items.reverse();\r\n      } else {\r\n        items.forEach((item) => {\r\n          if (item.element.classList.contains(className)) {\r\n            moveBack(item);\r\n          }\r\n        });\r\n\r\n        items.reverse();\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * @param {dNode} dNode\r\n   */\r\n  function moveTo(dNode) {\r\n    const { to, element, order } = dNode;\r\n\r\n    dNode.index = getIndexInParent(dNode.element, dNode.element.parentElement);\r\n    element.classList.add(className);\r\n\r\n    if (order === 'last' || order >= to.children.length) {\r\n      to.append(element);\r\n\r\n      return;\r\n    }\r\n\r\n    if (order === 'first') {\r\n      to.prepend(element);\r\n\r\n      return;\r\n    }\r\n\r\n    to.children[order].before(element);\r\n  }\r\n\r\n  /**\r\n   * @param {dNode} dNode\r\n   */\r\n  function moveBack(dNode) {\r\n    const { parent, element, index } = dNode;\r\n\r\n    element.classList.remove(className);\r\n\r\n    if (index >= 0 && parent.children[index]) {\r\n      parent.children[index].before(element);\r\n    } else {\r\n      parent.append(element);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {HTMLElement} element\r\n   * @param {HTMLElement} parent\r\n   */\r\n  function getIndexInParent(element, parent) {\r\n    return [...parent.children].indexOf(element);\r\n  }\r\n\r\n  /**\r\n   * Функция сортировки массива по breakpoint и order\r\n   * по возрастанию для type = min\r\n   * по убыванию для type = max\r\n   *\r\n   * @param {dNode[]} items\r\n   */\r\n  function sortDNodes(items) {\r\n    const isMin = type === 'min' ? 1 : 0;\r\n\r\n    return [...items].sort((a, b) => {\r\n      if (a.breakpoint === b.breakpoint) {\r\n        if (a.order === b.order) {\r\n          return 0;\r\n        }\r\n\r\n        if (a.order === 'first' || b.order === 'last') {\r\n          return -1 * isMin;\r\n        }\r\n\r\n        if (a.order === 'last' || b.order === 'first') {\r\n          return 1 * isMin;\r\n        }\r\n\r\n        return 0;\r\n      }\r\n\r\n      return (a.breakpoint - b.breakpoint) * isMin;\r\n    });\r\n  }\r\n\r\n  function isNumber(value) {\r\n    return !isNaN(value);\r\n  }\r\n}\r\n\r\nuseDynamicAdapt('min');\r\n"]}